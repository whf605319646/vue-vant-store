(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cart"],{5721:function(t,i,e){"use strict";var o=e("9cf9"),s=e.n(o);s.a},"9cf9":function(t,i,e){},a10a:function(t,i,e){"use strict";e.r(i);var o=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"cart"},[e("van-nav-bar",{attrs:{title:"购物车","right-text":t.rightText,"z-index":10,fixed:""},on:{"click-right":t.editCart}}),this.cartList.length?t._e():e("div",{staticClass:"nogood"},[e("div",[t._v("购物车空空的，快去购物吧~")]),e("van-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.goHome}},[t._v("去首页")])],1),e("van-checkbox-group",{staticClass:"card-goods",model:{value:t.checkedGoods,callback:function(i){t.checkedGoods=i},expression:"checkedGoods"}},t._l(t.cartList,function(i){return e("van-checkbox",{key:i.Goodid,staticClass:"card-goods__item",attrs:{name:i.Goodid}},[e("van-card",{attrs:{title:i.Goodname,desc:i.Gooddescribe,num:i.Cartcount,price:t.formatPrice(i.GoodPriceaftersale),thumb:i.GoodImg}},[e("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[e("span",{staticClass:"add",on:{click:function(e){e.stopPropagation(),t.reduceCount(i,i.Cartcount)}}},[e("van-button",{staticClass:"btn",attrs:{size:"mini"}},[t._v("-")])],1),e("span",{staticClass:"input",on:{click:function(e){e.stopPropagation(),t.showModal(i)}}},[e("span",{staticClass:"input-edit"},[t._v(t._s(i.Cartcount))])]),e("span",{staticClass:"reduce",on:{click:function(e){e.stopPropagation(),t.addCount(i,i.Cartcount)}}},[e("van-button",{staticClass:"btn",attrs:{size:"mini"}},[t._v("+")])],1)])])],1)})),e("van-dialog",{attrs:{"show-cancel-button":"","before-close":t.beforeClose,title:"数量修改"},model:{value:t.modalShow,callback:function(i){t.modalShow=i},expression:"modalShow"}},[e("div",{staticClass:"modal-box"},[e("span",{staticClass:"add",on:{click:function(i){return i.stopPropagation(),t.reduceEditCount(i)}}},[e("van-button",{staticClass:"btn",attrs:{size:"mini"}},[t._v("-")])],1),e("span",{staticClass:"input"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.editNum,expression:"editNum",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.editNum},on:{input:function(i){i.target.composing||(t.editNum=t._n(i.target.value))},blur:function(i){t.$forceUpdate()}}})]),e("span",{staticClass:"reduce",on:{click:function(i){return i.stopPropagation(),t.addEditCount(i)}}},[e("van-button",{staticClass:"btn",attrs:{size:"mini"}},[t._v("+")])],1)])]),this.cartList.length?e("van-submit-bar",{staticClass:"cart-bar",attrs:{price:t.isEdit?void 0:t.totalPrice,label:t.isEdit?"":"合计","button-text":t.isEdit?"删除":"提交订单"},on:{submit:t.onSubmit}},[e("span",{staticClass:"selectAll",on:{click:t.selectAll}},[e("van-checkbox",{model:{value:t.checkedAll,callback:function(i){t.checkedAll=i},expression:"checkedAll"}},[t._v(t._s(t.checkedAllMsg))])],1)]):t._e()],1)},s=[],c=(e("ac6a"),e("c93e")),n=e("b970"),a=e("2f62"),d=e("4ec3"),r={name:"Cart",data:function(){return{cartList:[],checkedGoods:[],checkedAll:!1,checkedAllMsg:"全选",isEdit:!1,modalShow:!1,editGood:{},editNum:0,timer:0}},activated:function(){this.init()},methods:Object(c["a"])({init:function(){var t=this;Object(d["f"])().then(function(i){t.cartList=i.data,t.checkedGoods=[]}).catch(function(t){console.log(t)})},editCart:function(){this.isEdit=!this.isEdit},reduceCount:function(t,i){i||0===i?i<=1?Object(n["c"])({position:"bottom",message:"不能再少了~"}):(i--,t.Cartcount=i,this.updateCartCountFun(t.Goodid,i)):Object(n["c"])({position:"bottom",message:"数值不正确~"})},addCount:function(t,i){i||0===i?i>=t.Goodcount?Object(n["c"])({position:"bottom",message:"只有这么多了~"}):(i++,t.Cartcount=i,this.updateCartCountFun(t.Goodid,i)):Object(n["c"])({position:"bottom",message:"数值不正确~"})},reduceEditCount:function(){this.editNum||0===this.editNum?this.editNum<=1?Object(n["c"])({position:"bottom",message:"不能再少了~"}):this.editNum--:Object(n["c"])({position:"bottom",message:"数值不正确~"})},addEditCount:function(){this.editNum||0===this.editNum?this.editNum>=this.editGood.Goodcount?Object(n["c"])({position:"bottom",message:"只有这么多了~"}):this.editNum++:Object(n["c"])({position:"bottom",message:"数值不正确~"})},showModal:function(t){this.modalShow=!0,this.editGood=t;var i=t.Cartcount;this.editNum=i},goHome:function(){this.$router.push("/")},beforeClose:function(t,i){if("confirm"===t){if(!this.editNum)return Object(n["c"])({position:"bottom",message:"数值不正确~"}),void i(!1);if(this.editNum>this.editGood.Goodcount)return Object(n["c"])({position:"bottom",message:"库存不够了~"}),void i(!1);if(this.editNum<1)return Object(n["c"])({position:"bottom",message:"数量太少了~"}),void i(!1);this.editGood.Cartcount=this.editNum,this.updateCartCountFun(this.editGood.Goodid,this.editNum),i()}else i()},formatPrice:function(t){return t.toFixed(2)},selectAll:function(){if(this.checkedAll){for(var t=0;t<this.cartList.length;t++)this.checkedGoods.push(this.cartList[t].Goodid);this.checkedAllMsg="全不选"}else this.checkedGoods=[],this.checkedAllMsg="全选"},updateCartCountFun:function(t,i){clearTimeout(this.timer),this.timer=setTimeout(function(){Object(d["l"])({id:t,num:i}).then(function(t){console.log(t)}).catch(function(t){console.log(t)})},500)},onSubmit:function(){var t=this;if(this.isEdit){if(!this.checkedGoods.length)return void Object(n["c"])({position:"bottom",message:"没有选择物品~"});n["a"].confirm({title:"警告",message:"确实要删除吗?"}).then(function(){var i={delId:t.checkedGoods};Object(d["c"])(i).then(function(i){console.log(i),t.$toast.success("删除成功"),t.init()}).catch(function(t){console.log(t)})})}else{if(!this.checkedGoods.length)return void Object(n["c"])({position:"bottom",message:"没有选择物品~"});var i=this.cartList.filter(function(i){if(-1!==t.checkedGoods.indexOf(i.Goodid))return i});this.setOrderGood(i),this.$router.push("/Order")}}},Object(a["c"])({setOrderGood:"SET_ORDERGOOD_MUTATION"})),computed:{totalPrice:function(){var t=this,i=0;return this.cartList.forEach(function(e){i+=-1!==t.checkedGoods.indexOf(e.Goodid)?e.GoodPrice*e.Cartcount:0}),100*i},rightText:function(){return this.cartList.length?this.isEdit?"完成":"编辑":""}},watch:{checkedGoods:function(){this.checkedGoods.length===this.cartList.length&&(this.checkedAll=!0,this.checkedAllMsg="全不选"),this.checkedGoods.length<this.cartList.length&&(this.checkedAll=!1,this.checkedAllMsg="全选")}}},u=r,l=(e("5721"),e("2877")),h=Object(l["a"])(u,o,s,!1,null,null,null);h.options.__file="Cart.vue";i["default"]=h.exports},ac6a:function(t,i,e){for(var o=e("cadf"),s=e("0d58"),c=e("2aba"),n=e("7726"),a=e("32e9"),d=e("84f2"),r=e("2b4c"),u=r("iterator"),l=r("toStringTag"),h=d.Array,m={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=s(m),b=0;b<f.length;b++){var p,g=f[b],C=m[g],v=n[g],k=v&&v.prototype;if(k&&(k[u]||a(k,u,h),k[l]||a(k,l,g),d[g]=h,C))for(p in o)k[p]||c(k,p,o[p],!0)}}}]);
//# sourceMappingURL=Cart.675c65c6.js.map